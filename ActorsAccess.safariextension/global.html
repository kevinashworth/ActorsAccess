<!DOCTYPE html>
<html>
<head>
<title>Actors Access</title>
<script type="text/javascript" language="javascript" charset="utf-8">

console.log('start of global.html');

safari.application.addEventListener("message", messageHandler, false);
safari.extension.settings.addEventListener("change", changeHandler, false);

function messageHandler(e) {
/*
	console.log(safari.extension.settings.bLoginAutomatically);
	console.log(safari.extension.settings);
	console.log(safari.extension.settings.getItem("bLoginAutomatically"));
*/
	if (e.name === "getSettings") {
		e.target.page.dispatchMessage("setSettings", {
			bLoginAutomatically: safari.extension.settings.getItem("bLoginAutomatically"),
			bPrevNext: safari.extension.settings.getItem("bPrevNext"),
			bHideMessages: safari.extension.settings.getItem("bHideMessages"),
			bHideFeaturedExtra: safari.extension.settings.getItem("bHideFeaturedExtra"),
			bAddProLink: safari.extension.settings.getItem("bAddProLink")
		});
	}
}

function changeHandler(e) {
	console.log("settingsChanged: " + e.name + "; " + e.target);
}

</script>
</head>
<body>
</body>
</html>